{"version":3,"sources":["../src/ptab.js"],"names":["require","request","base","Model","Manager","PtabModel","PtabManager","getPage","page","metadata","count","pageNumber","pages","get","url","endpoint","qs","params","offset","json","Math","floor","iteratorIndex","index","modelClass","results","PtabTrial","documents","PtabDocument","objects","filter","trialNumber","PtabTrialManager","trial","PtabDocumentManager","module","exports"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAAA,OAAO,CAAC,iBAAD,CAAP;;AACA,IAAMC,OAAO,GAAGD,OAAO,CAAC,wBAAD,CAAvB;;AACA,IAAME,IAAI,GAAGF,OAAO,CAAC,QAAD,CAApB;;AAEA,IAAMG,KAAK,GAAGD,IAAI,CAACC,KAAnB;AACA,IAAMC,OAAO,GAAGF,IAAI,CAACE,OAArB;;IAEMC,S;;;;;;;;;;;;EAAkBF,K;;AAAQ;;IAE1BG,W;;;;;;;;;;;;;;;;;;;;;;;uBAEmB,KAAKC,OAAL,CAAa,CAAb,C;;;AAAbC,gBAAAA,I;iDACGA,IAAI,CAACC,QAAL,CAAcC,K;;;;;;;;;;;;;;;;;;;;;gDAGXC,U;;;;;;oBACJA,UAAU,IAAI,KAAKC,K;;;;;;uBACJX,OAAO,CAACY,GAAR,CAAY;AACzBC,kBAAAA,GAAG,EAAE,yCAAyC,KAAKC,QAD1B;AAEzBC,kBAAAA,EAAE,oBAAO,KAAKC,MAAZ,EAAuB;AAACC,oBAAAA,MAAM,EAAEP,UAAU,GAAG;AAAtB,mBAAvB,CAFuB;AAGzBQ,kBAAAA,IAAI,EAAE;AAHmB,iBAAZ,C;;;AAAbX,gBAAAA,I;AAKJ,qBAAKI,KAAL,CAAWD,UAAX,IAAyBH,IAAzB;;;kDAEG,KAAKI,KAAL,CAAWD,UAAX,C;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIHA,gBAAAA,U,GAAaS,IAAI,CAACC,KAAL,CAAW,KAAKC,aAAL,GAAqB,EAAhC,C;AACbC,gBAAAA,K,GAAQ,KAAKD,aAAL,GAAqB,E;AACjC,qBAAKA,aAAL;;uBACiB,KAAKf,OAAL,CAAaI,UAAb,C;;;AAAbH,gBAAAA,I;kDACG,IAAI,KAAKgB,UAAT,CAAoBhB,IAAI,CAACiB,OAAL,CAAaF,KAAb,CAApB,C;;;;;;;;;;;;;;;;;;;EAvBWnB,O;;AA0BzB;;IAEKsB,S;;;;;AACF,qBAAYT,MAAZ,EAAmB;AAAA;;AAAA;;AACf,mFAAMA,MAAN;AACA,UAAKU,SAAL,GAAiBC,YAAY,CAACC,OAAb,CAAqBC,MAArB,CAA4B,MAAKC,WAAjC,CAAjB;AAFe;AAGlB;;;EAJmB1B,S;;AAKvB;;IAEK2B,gB;;;;;;;;;;;;;;;;;;oEACa,a;;gEACJ,Q;;kEACEN,S;;;;;;EAHcpB,W;;IAMzBsB,Y;;;;;AACF,wBAAYX,MAAZ,EAAmB;AAAA;;AAAA;;AACf,uFAAMA,MAAN;AACA,WAAKgB,KAAL,GAAaL,YAAY,CAACC,OAAb,CAAqBC,MAArB,CAA4B,OAAKC,WAAjC,CAAb;AAFe;AAGlB;;;EAJsB1B,S;;AAK1B;;IAEK6B,mB;;;;;;;;;;;;;;;;;;oEACa,a;;gEACJ,W;;kEACEN,Y;;;;;;EAHiBtB,W;;AAKlCoB,SAAS,CAACG,OAAV,GAAoB,IAAIG,gBAAJ,CAAqB,EAArB,CAApB;AACAJ,YAAY,CAACC,OAAb,GAAuB,IAAIK,mBAAJ,CAAwB,EAAxB,CAAvB;AAEAC,MAAM,CAACC,OAAP,GAAiB;AACbV,EAAAA,SAAS,EAAEA,SADE;AAEbE,EAAAA,YAAY,EAAEA;AAFD,CAAjB","sourcesContent":["require(\"@babel/polyfill\");\nconst request = require('request-promise-native');\nconst base = require('./base')\n\nconst Model = base.Model\nconst Manager = base.Manager\n\nclass PtabModel extends Model {};\n\nclass PtabManager extends Manager {\n    async length() {\n        let page = await this.getPage(0)\n        return page.metadata.count\n    }\n\n    async getPage(pageNumber) {\n        if (!(pageNumber in this.pages)) {\n            let page = await request.get({\n                url: \"https://ptabdata.uspto.gov/ptab-api/\" + this.endpoint,\n                qs:  {...this.params, ...{offset: pageNumber * 25}},\n                json: true,\n            })\n            this.pages[pageNumber] = page\n        }\n        return this.pages[pageNumber]\n    }\n\n    async next() {\n        let pageNumber = Math.floor(this.iteratorIndex / 25);\n        let index = this.iteratorIndex % 25;\n        this.iteratorIndex++\n        let page = await this.getPage(pageNumber);\n        return new this.modelClass(page.results[index]);\n    }\n\n};\n\nclass PtabTrial extends PtabModel {\n    constructor(params){\n        super(params)\n        this.documents = PtabDocument.objects.filter(this.trialNumber)\n    }\n};\n\nclass PtabTrialManager extends PtabManager {\n    defaultQuery = \"trialNumber\"\n    endpoint = \"trials\"\n    modelClass = PtabTrial\n}\n\nclass PtabDocument extends PtabModel {\n    constructor(params){\n        super(params)\n        this.trial = PtabDocument.objects.filter(this.trialNumber)\n    }\n};\n\nclass PtabDocumentManager extends PtabManager {\n    defaultQuery = \"trialNumber\"\n    endpoint = \"documents\"\n    modelClass = PtabDocument\n}\nPtabTrial.objects = new PtabTrialManager({})\nPtabDocument.objects = new PtabDocumentManager({})\n\nmodule.exports = {\n    PtabTrial: PtabTrial,\n    PtabDocument: PtabDocument,\n}"],"file":"ptab.js"}