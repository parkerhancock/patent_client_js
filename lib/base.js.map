{"version":3,"sources":["../src/base.js"],"names":["require","Model","data","Object","keys","key","includes","Date","Symbol","asyncIterator","Manager","params","length","i","pageNumber","Math","floor","position","getPage","page","docLocation","split","reduce","agg","next","modelClass","applyDefaultQuery","pages","String","defaultQuery","constructor","manager","filter","Error","first","item","value","fetchPage","module","exports"],"mappings":"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","sourcesContent":["require(\"@babel/polyfill\");\n\nclass Model {\n    constructor(data) {\n        for (var key of Object.keys(data)) {\n            this[key] = (key.includes(\"Date\") ? new Date(data[key]) : data[key]);\n        }\n    }\n}\n\nclass Manager {\n    constructor (params) {\n        this.params = this.applyDefaultQuery(params);\n        this.pages = {}\n        this.docLocation = \"results\"\n    }\n\n    [Symbol.asyncIterator] = async function*() {\n        let length = await this.length()\n        for (let i = 0; i < length; i++) {\n            let pageNumber = Math.floor(i / 20);\n            let position = i % 20;\n            let page = await this.getPage(pageNumber);\n            let data = null\n            if (this.docLocation) {\n                data = this.docLocation.split(\".\").reduce((agg, next) => agg[next], page)\n            } else {\n                data = page\n            }\n            yield new this.modelClass(data[position])\n        }\n    }\n\n    applyDefaultQuery(params) {\n        if (typeof params === 'string' || params instanceof String) {\n            params = {[this.defaultQuery]: params}\n        } \n        return params\n    }\n\n    filter(params) {\n        return new this.constructor({...this.params, ...this.applyDefaultQuery(params)})\n    }\n\n    async get(params) {\n        let manager = this.filter(params)\n        let length = manager.length()\n        if (length > 1) {\n            throw new Error(\"More than one object found!\")\n        } else if (length == 0) {\n            throw new Error(\"No objects found!\")\n        }\n        return manager.first()\n    }\n\n    async first() {\n        let item = await this[Symbol.asyncIterator]().next()\n        return item.value\n    }\n\n    async getPage(pageNumber) {\n        if (!(pageNumber in this.pages)) {\n            this.pages[pageNumber] = await this.fetchPage(pageNumber)\n        }\n        return this.pages[pageNumber]\n    }\n};\n\nmodule.exports = {\n    Model: Model,\n    Manager: Manager,\n}"],"file":"base.js"}